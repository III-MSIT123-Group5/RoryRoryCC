@model IEnumerable<BusinessSystemMVC_Admin_page_.Models.LeaveHistoryApprovalTemp>

@section Styles{
    <style>
        button {
            font-family: 'NotoSansCJKtc-Bold';
        }

        h2 {
            font-family: 'NotoSansCJKtc-Bold';
        }
    </style>

    <link href="//cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap4.min.css" rel="stylesheet" />
}

<h2>待簽核假單</h2>
<div style="width:92%">
    <table id="LeaveSigntable" class="table table-striped table-bordered">
        <thead>
            <tr>
                <th>員工姓名</th>
                <th>假別</th>
                <th>部門</th>
                <th>組別</th>
                <th>職稱</th>
                <th>申請時間</th>
                <th>起始時間</th>
                <th>結束時間</th>
                <th>詳細資料/核准/駁回</th>
            </tr>
        </thead>
    </table>
</div>

@section scripts{
    <script src="//cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js"></script>
    <script src="/Scripts/moment.js"></script>

    <script>

        $(document).ready(function () {
              SigndataTable = $('#LeaveSigntable').DataTable({
                "ajax": {
                    url: '@Url.Action("LeaveSigntureLoadData", "LeaveHistoryApprovalTemps")',
                    method: 'GET',
                    dataType: 'json'
                },
                "columnDefs": [
                    { "targets": 0, "data": "EmployeeName", "width": "55px" },
                    { "targets": 1, "data": "leave_name", "width": "45px" },
                    { "targets": 2, "data": "name", "width": "45px" },
                    { "targets": 3, "data": "GroupName", "width": "45px" },
                    { "targets": 4, "data": "position1", "width": "45px" },
                    { "targets": 5, "data": "ReleaseTime", "render": function (data) { return moment(data).format("YYYY-MM-DD HH:mm:ss") }, "width": "120px" },
                    { "targets": 6, "data": "StartTime", "render": function (data) { return moment(data).format("YYYY-MM-DD HH:mm:ss") }, "width": "120px" },
                    { "targets": 7, "data": "EndTime", "render": function (data) { return moment(data).format("YYYY-MM-DD HH:mm:ss") }, "width": "120px" },
                   {
                       "targets": 8, "data": "ID", "render": function (data) {
                           return `<a class='btn btn-warning btn-sm' onclick=PopupDetail("@Url.Action("LoadDataDetail", "EmployeeApprovalTemps")/${data}")><i class="fa fa-align-left"></i> 詳細資料</a><a class='btn btn-warning btn-sm'  style='margin-left:5px' onclick=AcceptSign("@Url.Action("AcceptRegister", "EmployeeApprovalTemps")/${data}")><i class="fa fa-check-square-o"></i> 核准</a><a class='btn btn-danger btn-sm' style='margin-left:5px' onclick=RejectSign("@Url.Action("RejectRegister", "EmployeeApprovalTemps")/${data}")><i class='fa fa-hand-paper-o'></i> 駁回</a>`
                        },
                        "orderable": false,
                        "searchable": false,
                        "width": "150px"
                    }
                ],
                "language": {
                    "emptyTable": "無待簽核申請。"
                }
            });
        });


        //===============
        function PopupDetail(Url) {
            var formDiv = $('<div/>');
            $.get(Url)
                .done(function (response) {
                    formDiv.html(response);
                    Popup = formDiv.dialog({
                        autoOpen: true,
                        resizable: false,
                        title: '詳細資料',
                        height: 500,
                        width: 400,
                        close: function () {
                            Popup.dialog('destroy').remove();
                        }
                    });
                });
        }



    </script>
}

